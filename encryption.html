<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>Privnote - Character Encryption</title>
<meta name="keywords" content="zero-width character encryption, binary encryption, secure messaging, encrypted notes, ephemeral messages,éšä¿¡äº‘">
<meta name="description" content="Privnote.chat allows you to encrypt messages using zero-width characters and binary formats, ensuring secure and private messaging.">
<meta property="og:image" content="privnote.png">
<meta property="og:url" content="https://privnote.chat/encryption.html">
<link rel="canonical" href="https://privnote.chat/encryption.html">
<meta property="og:type" content="website">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap & Font Awesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9224406325142860" crossorigin="anonymous"></script>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "Organization",
"name": "Privnote",
"url": "https://privnote.chat",
"logo": "https://privnote.chat/read/pic/noti.png",
"contactPoint": {
"@type": "ContactPoint",
"email": "contact@privnote.chat",
"contactType": "customer service"
}
}
</script>

<style>
/* Enhanced Mobile Header Styles */
@media (max-width: 767px) {
  .site-header {
    padding: 10px 5px;
    background-color: #343a40;
  }
  .logo-text {
    font-size: 1.3rem;
    margin-bottom: 0;
    white-space: nowrap;
  }
  .logo-container {
    display: flex;
    align-items: center;
  }
  .logo-icon {
    color: #FFC107;
    font-size: 1.3rem;
    margin-right: 3px;
  }
  .language-dropdown {
    margin-right: 5px;
  }
  .language-dropdown .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
  }
  .tagline {
    display: none;
  }
  .mobile-tagline {
    display: block;
    text-align: center;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.8);
    margin-top: 5px;
    font-style: italic;
  }
  .header-row {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  .header-controls {
    display: flex;
    align-items: center;
  }
  
  /* Improved mobile navigation */
  #mainNav {
    overflow-x: auto;
    flex-wrap: nowrap;
    padding-bottom: 2px;
    max-width: 100%;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }
  #mainNav::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  #mainNav .nav-link {
    padding: 0.4rem 0.6rem;
    white-space: nowrap;
    font-size: 0.9rem;
  }
  
  /* Improved form controls for mobile */
  .main-container {
    padding: 0 8px;
  }
  .form-label {
    font-size: 0.85rem;
    margin-bottom: 0.2rem;
  }
  textarea.form-control {
    font-size: 0.9rem;
    padding: 0.4rem;
  }
  .btn {
    padding: 0.35rem 0.65rem;
    font-size: 0.9rem;
  }
  
  /* Improved alert and card styling */
  .alert {
    padding: 0.6rem;
    font-size: 0.85rem;
  }
  .card-body {
    padding: 0.75rem;
  }
  
  /* Fix dropdown on mobile */
  .dropdown-menu {
    position: absolute;
    min-width: 7rem;
  }
}

/* Extra small devices (phones, 576px and down) */
@media (max-width: 576px) {
  .site-header {
    padding: 8px 4px;
  }
  .logo-text {
    font-size: 1.2rem;
  }
  .logo-icon {
    font-size: 1.2rem;
  }
  #mainNav .nav-link {
    padding: 0.35rem 0.5rem;
    font-size: 0.85rem;
  }
  h5.mb-3 {
    font-size: 1.1rem;
    margin-bottom: 0.5rem !important;
  }
  .form-label {
    font-size: 0.8rem;
  }
  .row.mb-3 {
    margin-bottom: 0.5rem !important;
  }
  textarea.form-control, input.form-control {
    font-size: 0.85rem;
    padding: 0.35rem;
  }
  .btn {
    font-size: 0.85rem;
    padding: 0.3rem 0.6rem;
  }
}

@media (min-width: 768px) {
  .mobile-tagline {
    display: none;
  }
}

/* Add button hover/active states for better mobile feedback */
.btn:active {
  transform: translateY(1px);
}

/* Ensure scrolling works properly on mobile */
body {
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Fix modal display on mobile */
.modal-dialog {
  margin: 0.5rem;
}
@media (max-width: 576px) {
  .modal-dialog {
    max-width: 95%;
    margin: 0.25rem auto;
  }
  .modal-body {
    padding: 0.5rem;
  }
  .modal-footer, .modal-header {
    padding: 0.5rem;
  }
}

/* Dropdown styling for language selector */
.dropdown-item.active {
  background-color: #f8f9fa;
  color: #007bff;
  font-weight: bold;
}
.dropdown-item.active::before {
  content: "âœ“ ";
}
</style>

</head>

<body class="d-flex flex-column min-vh-100">
<header class="site-header">
<div class="container-fluid d-flex justify-content-between align-items-center">
<a class="text-decoration-none" href="https://privnote.chat">
<h1 class="logo-text">Priv<i class="fas fa-unlock-alt"></i>ote.chat</h1>
</a>
<div class="d-flex align-items-center">
<div class="dropdown me-3">
<button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
<span id="currentLanguage">English</span>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
<li><a class="dropdown-item" href="#" onclick="switchLanguage('en')">ğŸ‡ºğŸ‡¸ English</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('zh')">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('tw')">ğŸ‡¹ğŸ‡¼ ä¸­æ–‡</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('es')">ğŸ‡ªğŸ‡¸ EspaÃ±ol</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('fr')">ğŸ‡«ğŸ‡· FranÃ§ais</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('ja')">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('de')">ğŸ‡©ğŸ‡ª Deutsch</a></li>
</ul>
</div>
<div id="trans1" class="tagline">Secure your words, vanish your trace</div>
</div>
</div>
</header>

<!-- Navigation Links -->
<div class="container">
  <ul class="nav nav-tabs justify-content-center mb-4" id="mainNav">
    <li class="nav-item">
      <a class="nav-link" href="index.html">
        <span id="navLinkText">Generate Link</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link active" href="encryption.html">
        <span id="navEncryptText">Character Encryption</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="decrypt.html">
        <span id="navDecryptText">Decrypt</span>
      </a>
    </li>
  </ul>
</div>

<main class="flex-grow-1">
<div class="container main-container">
    <h5 class="mb-3 mt-4 pt-2 text-center" id="encryptTabTitle">Character Encryption Tool</h5>

    <!-- First textarea - Input area -->
    <div class="mb-3">
      <label for="myTextarea" class="form-label"><i class="fas fa-edit me-1"></i>Public Message (Input)</label>
      <textarea class="form-control" id="myTextarea" rows="5" placeholder="Write Your Note Here..." style="border-left: 4px solid #3498db;"></textarea>
    </div>
    
    <!-- Hidden textarea - will be moved to bottom after encryption -->
    <div class="mb-3" id="hiddenTextContainer">
      <label for="HiddenTextarea" class="form-label"><i class="fas fa-eye-slash me-1"></i>Secret Message (Input)</label>
      <textarea class="form-control" id="HiddenTextarea" rows="5" placeholder="Write Hidden Messages Here..." style="border-left: 4px solid #9b59b6;"></textarea>
    </div>

    <!-- Password inputs -->
    <div class="row mb-3">
      <div class="col-md-6 mb-2 mb-md-0">
        <label for="pass1" class="form-label">Password</label>
        <input type="password" class="form-control" id="pass1" placeholder="Enter Password" autocomplete="off" required>
      </div>
      <div class="col-md-6">
        <label for="pass2" class="form-label">Confirm Password</label>
        <input type="password" class="form-control" id="pass2" placeholder="Confirm Password" required>
      </div>
    </div>

    <!-- Encrypt button -->
    <div class="d-grid gap-2 d-md-flex justify-content-md-center mb-4">
      <button id="tranmake" type="button" class="btn btn-warning px-4 py-2" onclick="create()">
        <i class="fas fa-lock me-2"></i>Encrypt Note
      </button>
    </div>

    <!-- Result display area -->
    <div class="alert alert-success" id="encryptinfo" style="display: none">
      <strong>Success!</strong> <span>The note has been successfully encrypted with two methods: the upper box contains zero-width character encryption, storing the information within the text, while the lower box shows the encryption as binary (0s and 1s). Both can be copied and used for decryption.</span>
    </div>

    <!-- Cover text copy area - ä½¿ç”¨çº¢è‰²ä¸»é¢˜ -->
    <div class="mb-3">
      <label for="coverCopy" class="form-label"><i class="fas fa-key me-1"></i>Zero-Width Encrypted Result (Copy to Share)</label>
      <textarea class="form-control mb-2" id="coverCopy" rows="5" placeholder="Encrypted content will appear here" readonly style="border-left: 4px solid #dc3545; background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9)) !important;"></textarea>
      <div class="d-flex justify-content-center">
        <button class="btn btn-danger" type="button" onclick="copyTextarea('coverCopy')">
          <i class="fas fa-copy me-2"></i>Copy Zero-Width Result
        </button>
      </div>
    </div>

    <!-- Card for link generation -->
    <div class="card" id="resultlink" style="display: none">
      <div class="card-body">
        <h6 class="card-title">PrivNote has been made</h6>
        <ul class="list-group list-group-flush mb-3">
          <li class="list-group-item list-group-item-success" id="innerlink"></li>
          <li id="tranli" class="list-group-item list-group-item-warning">The message will be automatically destroyed according to your settings.</li>
        </ul>
        <button type="button" class="btn btn-outline-secondary" id="copybutton" onclick="copylink()">
          <i class="fas fa-copy me-2"></i>Copy Link
        </button>
      </div>
    </div>
    
    <!-- Container for Hidden Text after encryption -->
    <div id="hiddenTextAfterEncrypt"></div>
</div>
</main>

<footer class="mt-auto">
<div class="container">
  <div class="text-center mb-3" id="blog-bottom-link">
    <a href="blog/index.html" class="btn btn-outline-primary"><i class="fas fa-blog me-2"></i>Blog</a>
  </div>
<p class="text-center mb-0">
<a href="read/selfdestructANDencoding.php" class="nav-link">
&copy;2025 MaiPDF.com<br><span class="__cf_email__" data-cfemail="b7ddd8d2f7c7d3d1dfd8c4c399d8d9dbded9d2">[email&#160;protected]</span>
</a>
</p>
</div>
</footer>

<div class="modal fade" id="myModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">How to decode messages</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <img id="decrysrc" src="read/pic/enDecode1.png" class="img-fluid" alt="changecode">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>

<!-- All JavaScript in one place, no external dependencies -->
<script>
// =======================================================================
// 1. TRANSLATION STRINGS AND LANGUAGE SWITCHING FUNCTIONALITY
// =======================================================================

// Common language strings for main pages
const languageCommonStrings = {
  en: {
    tagline: 'Secure your words, vanish your trace',
    navLinkText: 'Generate Link',
    navEncryptText: 'Character Encryption',
    navDecryptText: 'Decrypt',
    currentLanguage: 'English'
  },
  zh: {
    tagline: 'å®‰å…¨ä¼ ä¿¡ï¼ŒéšåŒ¿æ— è¸ª',
    navLinkText: 'ç”Ÿæˆé“¾æ¥',
    navEncryptText: 'å­—ç¬¦åŠ å¯†',
    navDecryptText: 'è§£å¯†å·¥å…·',
    currentLanguage: 'ä¸­æ–‡'
  },
  tw: {
    tagline: 'å®‰å…¨å‚³ä¿¡ï¼Œéš±åŒ¿ç„¡è¹¤',
    navLinkText: 'ç”Ÿæˆé€£çµ',
    navEncryptText: 'å­—å…ƒåŠ å¯†',
    navDecryptText: 'è§£å¯†å·¥å…·',
    currentLanguage: 'ä¸­æ–‡'
  },
  es: {
    tagline: 'Asegura tus palabras, desvanece tu rastro',
    navLinkText: 'Generar Enlace',
    navEncryptText: 'Cifrado de Caracteres',
    navDecryptText: 'Descifrar',
    currentLanguage: 'EspaÃ±ol'
  },
  fr: {
    tagline: 'SÃ©curisez vos mots, faites disparaÃ®tre votre trace',
    navLinkText: 'GÃ©nÃ©rer un Lien',
    navEncryptText: 'Chiffrement de CaractÃ¨res',
    navDecryptText: 'DÃ©chiffrer',
    currentLanguage: 'FranÃ§ais'
  },
  ja: {
    tagline: 'ã‚ãªãŸã®è¨€è‘‰ã‚’å®ˆã‚Šã€ç—•è·¡ã‚’æ¶ˆã™',
    navLinkText: 'ãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆ',
    navEncryptText: 'æ–‡å­—ã®æš—å·åŒ–',
    navDecryptText: 'å¾©å·',
    currentLanguage: 'æ—¥æœ¬èª'
  },
  de: {
    tagline: 'Sichern Sie Ihre Worte, verschwinden Sie Ihre Spur',
    navLinkText: 'Link generieren',
    navEncryptText: 'ZeichenverschlÃ¼sselung',
    navDecryptText: 'EntschlÃ¼sseln',
    currentLanguage: 'Deutsch'
  }
};

// Encryption page specific strings
const languageEncryptionStrings = {
  en: {
    encryptTabTitle: 'Character Encryption Tool',
    coverTextLabel: 'Public Message (Input)',
    coverTextPlaceholder: 'Write Your Note Here...',
    hiddenTextLabel: 'Secret Message (Input)',
    hiddenTextPlaceholder: 'Write Hidden Messages Here...',
    encryptKeyLabel: 'Password',
    encryptKeyLabelConfirm: 'Confirm Password',
    encryptKeyPlaceholder: 'Enter Password',
    encryptKeyPlaceholderConfirm: 'Confirm Password',
    pass1Placeholder: 'Enter Password',
    pass2Placeholder: 'Confirm Password',
    btnZeroWidthEncrypt: 'Zero-Width Encrypt',
    btnBinaryEncrypt: 'Binary Encrypt',
    encryptResultLabel: 'Zero-Width Encrypted Result (Copy to Share)',
    encryptResultPlaceholder: 'Encrypted content will appear here',
    binaryResultLabel: 'Binary Encryption Result',
    textareaPlaceholder: 'Write Your Note Here...',
    tranmake: 'Encrypt Note',
    btnCopyEncryptResult: 'Copy Zero-Width Result',
    btnCopyBinaryResult: 'Copy Binary Result',
    encryptInfo: '<strong>Info:</strong> Zero-width encryption hides the hidden content in the cover text. Binary encryption converts the hidden content to 0/1. You can set a custom password.',
    hiddenTextareaPlaceholder: 'Write Hidden Messages Here...',
    alertPasswordMismatch: 'Password does not match or clear password',
    alertContentTooLong: 'Too long.....',
    alertWriteSomething: 'Write something on note',
    mobileAlertShort: 'Encryption successful! Upper box: zero-width characters. Lower box: binary format.',
    mobileAlertMedium: 'Encryption complete. The top box contains zero-width character encryption, while the bottom shows binary encryption.',
    tranli: 'The message will be automatically destroyed according to your settings.'
  },
  zh: {
    encryptTabTitle: 'å­—ç¬¦åŠ å¯†å·¥å…·',
    coverTextLabel: 'è¡¨é¢å†…å®¹ï¼ˆè¾“å…¥ï¼‰',
    coverTextPlaceholder: 'åœ¨æ­¤è¾“å…¥ä¾¿ç­¾å†…å®¹...',
    hiddenTextLabel: 'éšè—å†…å®¹ï¼ˆè¾“å…¥ï¼‰',
    hiddenTextPlaceholder: 'åœ¨æ­¤è¾“å…¥éšè—å†…å®¹...',
    encryptKeyLabel: 'å¯†ç ',
    encryptKeyLabelConfirm: 'ç¡®è®¤å¯†ç ',
    encryptKeyPlaceholder: 'è¾“å…¥å¯†ç ',
    encryptKeyPlaceholderConfirm: 'ç¡®è®¤å¯†ç ',
    pass1Placeholder: 'è¾“å…¥å¯†ç ',
    pass2Placeholder: 'ç¡®è®¤å¯†ç ',
    btnZeroWidthEncrypt: 'é›¶å®½å­—ç¬¦åŠ å¯†',
    btnBinaryEncrypt: 'äºŒè¿›åˆ¶åŠ å¯†',
    encryptResultLabel: 'é›¶å®½å­—ç¬¦åŠ å¯†ç»“æœï¼ˆå¤åˆ¶åˆ†äº«ï¼‰',
    encryptResultPlaceholder: 'åŠ å¯†å†…å®¹å°†åœ¨æ­¤æ˜¾ç¤º',
    binaryResultLabel: 'äºŒè¿›åˆ¶åŠ å¯†ç»“æœ',
    textareaPlaceholder: 'åœ¨æ­¤è¾“å…¥ä¾¿ç­¾å†…å®¹...',
    tranmake: 'åŠ å¯†ä¾¿ç­¾',
    btnCopyEncryptResult: 'å¤åˆ¶é›¶å®½å­—ç¬¦ç»“æœ',
    btnCopyBinaryResult: 'å¤åˆ¶äºŒè¿›åˆ¶ç»“æœ',
    encryptInfo: '<strong>è¯´æ˜ï¼š</strong>é›¶å®½å­—ç¬¦åŠ å¯†ä¼šå°†éšè—å†…å®¹éšå†™è¿›è¡¨é¢å†…å®¹ï¼ŒäºŒè¿›åˆ¶åŠ å¯†åˆ™å°†éšè—å†…å®¹è½¬ä¸º0/1å­—ç¬¦ä¸²ã€‚å¯è‡ªå®šä¹‰å¯†ç ã€‚',
    hiddenTextareaPlaceholder: 'åœ¨æ­¤è¾“å…¥éšè—å†…å®¹...',
    alertPasswordMismatch: 'å¯†ç ä¸åŒ¹é…æˆ–æ¸…é™¤å¯†ç ',
    alertContentTooLong: 'å†…å®¹è¿‡é•¿.....',
    alertWriteSomething: 'è¯·åœ¨ä¾¿ç­¾ä¸Šå†™äº›å†…å®¹',
    mobileAlertShort: 'åŠ å¯†æˆåŠŸï¼ä¸Šæ¡†ï¼šé›¶å®½å­—ç¬¦ã€‚ä¸‹æ¡†ï¼šäºŒè¿›åˆ¶æ ¼å¼ã€‚',
    mobileAlertMedium: 'åŠ å¯†å®Œæˆã€‚é¡¶éƒ¨æ¡†åŒ…å«é›¶å®½å­—ç¬¦åŠ å¯†ï¼Œåº•éƒ¨æ˜¾ç¤ºäºŒè¿›åˆ¶åŠ å¯†ã€‚',
    tranli: 'æ¶ˆæ¯å°†æ ¹æ®æ‚¨çš„è®¾ç½®è‡ªåŠ¨é”€æ¯ã€‚'
  },
  tw: {
    encryptTabTitle: 'å­—å…ƒåŠ å¯†å·¥å…·',
    coverTextLabel: 'è¡¨é¢å…§å®¹ï¼ˆè¼¸å…¥ï¼‰',
    coverTextPlaceholder: 'åœ¨æ­¤è¼¸å…¥ä¾¿æ¢å…§å®¹...',
    hiddenTextLabel: 'éš±è—å…§å®¹ï¼ˆè¼¸å…¥ï¼‰',
    hiddenTextPlaceholder: 'åœ¨æ­¤è¼¸å…¥éš±è—å…§å®¹...',
    encryptKeyLabel: 'å¯†ç¢¼',
    encryptKeyLabelConfirm: 'ç¢ºèªå¯†ç¢¼',
    encryptKeyPlaceholder: 'è¼¸å…¥å¯†ç¢¼',
    encryptKeyPlaceholderConfirm: 'ç¢ºèªå¯†ç¢¼',
    pass1Placeholder: 'è¼¸å…¥å¯†ç¢¼',
    pass2Placeholder: 'ç¢ºèªå¯†ç¢¼',
    btnZeroWidthEncrypt: 'é›¶å¯¬å­—å…ƒåŠ å¯†',
    btnBinaryEncrypt: 'äºŒé€²ä½åŠ å¯†',
    encryptResultLabel: 'é›¶å¯¬å­—å…ƒåŠ å¯†çµæœï¼ˆè¤‡è£½åˆ†äº«ï¼‰',
    encryptResultPlaceholder: 'åŠ å¯†å…§å®¹å°‡é¡¯ç¤ºåœ¨æ­¤',
    binaryResultLabel: 'äºŒé€²ä½åŠ å¯†çµæœ',
    textareaPlaceholder: 'åœ¨æ­¤è¼¸å…¥ä¾¿æ¢å…§å®¹...',
    tranmake: 'åŠ å¯†ä¾¿æ¢',
    btnCopyEncryptResult: 'è¤‡è£½é›¶å¯¬å­—å…ƒçµæœ',
    btnCopyBinaryResult: 'è¤‡è£½äºŒé€²ä½çµæœ',
    encryptInfo: '<strong>èªªæ˜ï¼š</strong>é›¶å¯¬å­—å…ƒåŠ å¯†æœƒå°‡éš±è—å…§å®¹éš±å¯«é€²è¡¨é¢å…§å®¹ï¼ŒäºŒé€²ä½åŠ å¯†å‰‡å°‡éš±è—å…§å®¹è½‰ç‚º0/1å­—ä¸²ã€‚å¯è‡ªè¨‚å¯†ç¢¼ã€‚',
    hiddenTextareaPlaceholder: 'åœ¨æ­¤è¼¸å…¥éš±è—å…§å®¹...',
    alertPasswordMismatch: 'å¯†ç¢¼ä¸åŒ¹é…æˆ–æ¸…é™¤å¯†ç¢¼',
    alertContentTooLong: 'å…§å®¹éé•·.....',
    alertWriteSomething: 'è«‹åœ¨ä¾¿æ¢ä¸Šå¯«äº›å…§å®¹',
    mobileAlertShort: 'åŠ å¯†æˆåŠŸï¼ä¸Šæ¡†ï¼šé›¶å¯¬å­—å…ƒã€‚ä¸‹æ¡†ï¼šäºŒé€²ä½æ ¼å¼ã€‚',
    mobileAlertMedium: 'åŠ å¯†å®Œæˆã€‚ä¸Šæ¡†åŒ…å«é›¶å¯¬å­—å…ƒåŠ å¯†ï¼Œä¸‹æ¡†é¡¯ç¤ºäºŒé€²ä½åŠ å¯†ã€‚',
    tranli: 'è¨Šæ¯å°‡ä¾æ“šæ‚¨çš„è¨­å®šè‡ªå‹•éŠ·æ¯€ã€‚'
  },
  es: {
    encryptTabTitle: 'Herramienta de Cifrado de Caracteres',
    coverTextLabel: 'Mensaje PÃºblico (Entrada)',
    coverTextPlaceholder: 'Escriba su nota aquÃ­...',
    hiddenTextLabel: 'Mensaje Secreto (Entrada)',
    hiddenTextPlaceholder: 'Escriba mensajes ocultos aquÃ­...',
    encryptKeyLabel: 'ContraseÃ±a',
    encryptKeyLabelConfirm: 'Confirmar ContraseÃ±a',
    encryptKeyPlaceholder: 'Ingrese contraseÃ±a',
    encryptKeyPlaceholderConfirm: 'Confirme contraseÃ±a',
    pass1Placeholder: 'Ingrese contraseÃ±a',
    pass2Placeholder: 'Confirme contraseÃ±a',
    btnZeroWidthEncrypt: 'Cifrado de Ancho Cero',
    btnBinaryEncrypt: 'Cifrado Binario',
    encryptResultLabel: 'Resultado Cifrado de Ancho Cero (Copiar para Compartir)',
    encryptResultPlaceholder: 'El contenido cifrado aparecerÃ¡ aquÃ­',
    binaryResultLabel: 'Resultado de Cifrado Binario',
    textareaPlaceholder: 'Escriba su nota aquÃ­...',
    tranmake: 'Cifrar Nota',
    btnCopyEncryptResult: 'Copiar Resultado de Ancho Cero',
    btnCopyBinaryResult: 'Copiar Resultado Binario',
    encryptInfo: '<strong>Info:</strong> El cifrado de ancho cero oculta el contenido en el texto de cobertura. El cifrado binario convierte el contenido oculto a 0/1. Puede establecer una contraseÃ±a personalizada.',
    hiddenTextareaPlaceholder: 'Escriba mensajes ocultos aquÃ­...',
    alertPasswordMismatch: 'ContraseÃ±a no coincidente o borrar la contraseÃ±a',
    alertContentTooLong: 'Demasiado largo.....',
    alertWriteSomething: 'Escriba algo en la nota',
    mobileAlertShort: 'Â¡Cifrado exitoso! Cuadro superior: caracteres de ancho cero. Cuadro inferior: formato binario.',
    mobileAlertMedium: 'Cifrado completo. El cuadro superior contiene cifrado de caracteres de ancho cero, mientras que el inferior muestra cifrado binario.',
    tranli: 'El mensaje se destruirÃ¡ automÃ¡ticamente segÃºn su configuraciÃ³n.'
  },
  fr: {
    encryptTabTitle: 'Outil de Chiffrement de CaractÃ¨res',
    coverTextLabel: 'Message Public (EntrÃ©e)',
    coverTextPlaceholder: 'Ã‰crivez votre note ici...',
    hiddenTextLabel: 'Message Secret (EntrÃ©e)',
    hiddenTextPlaceholder: 'Ã‰crivez les messages cachÃ©s ici...',
    encryptKeyLabel: 'Mot de passe',
    encryptKeyLabelConfirm: 'Confirmer le Mot de passe',
    encryptKeyPlaceholder: 'Entrez le mot de passe',
    encryptKeyPlaceholderConfirm: 'Confirmez le mot de passe',
    pass1Placeholder: 'Entrez le mot de passe',
    pass2Placeholder: 'Confirmez le mot de passe',
    btnZeroWidthEncrypt: 'Chiffrer en Largeur ZÃ©ro',
    btnBinaryEncrypt: 'Chiffrer en Binaire',
    encryptResultLabel: 'RÃ©sultat ChiffrÃ© Ã  Largeur ZÃ©ro (Copier pour Partager)',
    encryptResultPlaceholder: 'Le rÃ©sultat chiffrÃ© apparaÃ®tra ici',
    binaryResultLabel: 'RÃ©sultat de Chiffrement Binaire',
    textareaPlaceholder: 'Ã‰crivez votre note ici...',
    tranmake: 'Chiffrer la Note',
    btnCopyEncryptResult: 'Copier le RÃ©sultat Ã  Largeur ZÃ©ro',
    btnCopyBinaryResult: 'Copier le RÃ©sultat Binaire',
    encryptInfo: '<strong>Info:</strong> Le chiffrement Ã  largeur zÃ©ro cache le contenu cachÃ© dans le texte de couverture. Le chiffrement binaire convertit le contenu cachÃ© en 0/1. Vous pouvez dÃ©finir un mot de passe personnalisÃ©.',
    hiddenTextareaPlaceholder: 'Ã‰crivez les messages cachÃ©s ici...',
    alertPasswordMismatch: 'Le mot de passe ne correspond pas ou effacez le mot de passe',
    alertContentTooLong: 'Trop long.....',
    alertWriteSomething: 'Ã‰crivez quelque chose sur la note',
    mobileAlertShort: 'Chiffrement rÃ©ussi ! BoÃ®te supÃ©rieure : caractÃ¨res Ã  largeur zÃ©ro. BoÃ®te infÃ©rieure : format binaire.',
    mobileAlertMedium: 'Chiffrement terminÃ©. La boÃ®te supÃ©rieure contient le chiffrement Ã  caractÃ¨res de largeur zÃ©ro, tandis que celle du bas affiche le chiffrement binaire.',
    tranli: 'Le message sera automatiquement dÃ©truit selon vos paramÃ¨tres.'
  },
  ja: {
    encryptTabTitle: 'æ–‡å­—æš—å·åŒ–ãƒ„ãƒ¼ãƒ«',
    coverTextLabel: 'å…¬é–‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå…¥åŠ›ï¼‰',
    coverTextPlaceholder: 'ã“ã“ã«ãƒ¡ãƒ¢ã‚’æ›¸ã„ã¦ãã ã•ã„...',
    hiddenTextLabel: 'ç§˜å¯†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå…¥åŠ›ï¼‰',
    hiddenTextPlaceholder: 'ã“ã“ã«éš ã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ã„ã¦ãã ã•ã„...',
    encryptKeyLabel: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
    encryptKeyLabelConfirm: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª',
    encryptKeyPlaceholder: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›',
    encryptKeyPlaceholderConfirm: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèª',
    pass1Placeholder: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›',
    pass2Placeholder: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèª',
    btnZeroWidthEncrypt: 'ã‚¼ãƒ­å¹…æš—å·åŒ–',
    btnBinaryEncrypt: 'ãƒã‚¤ãƒŠãƒªæš—å·åŒ–',
    encryptResultLabel: 'ã‚¼ãƒ­å¹…æš—å·åŒ–çµæœï¼ˆå…±æœ‰ç”¨ã«ã‚³ãƒ”ãƒ¼ï¼‰',
    encryptResultPlaceholder: 'æš—å·åŒ–ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™',
    binaryResultLabel: 'ãƒã‚¤ãƒŠãƒªæš—å·åŒ–çµæœ',
    textareaPlaceholder: 'ã“ã“ã«ãƒ¡ãƒ¢ã‚’æ›¸ã„ã¦ãã ã•ã„...',
    tranmake: 'ãƒ¡ãƒ¢ã‚’æš—å·åŒ–',
    btnCopyEncryptResult: 'ã‚¼ãƒ­å¹…çµæœã‚’ã‚³ãƒ”ãƒ¼',
    btnCopyBinaryResult: 'ãƒã‚¤ãƒŠãƒªçµæœã‚’ã‚³ãƒ”ãƒ¼',
    encryptInfo: '<strong>æƒ…å ±ï¼š</strong>ã‚¼ãƒ­å¹…æš—å·åŒ–ã¯éš ã—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚«ãƒãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã«éš ã—ã¾ã™ã€‚ãƒã‚¤ãƒŠãƒªæš—å·åŒ–ã¯éš ã—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’0/1ã«å¤‰æ›ã—ã¾ã™ã€‚ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã§ãã¾ã™ã€‚',
    hiddenTextareaPlaceholder: 'ã“ã“ã«éš ã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ã„ã¦ãã ã•ã„...',
    alertPasswordMismatch: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ãªã„ã‹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„',
    alertContentTooLong: 'é•·ã™ãã¾ã™.....',
    alertWriteSomething: 'ãƒ¡ãƒ¢ã«ä½•ã‹æ›¸ã„ã¦ãã ã•ã„',
    mobileAlertShort: 'æš—å·åŒ–æˆåŠŸï¼ä¸Šã®ãƒœãƒƒã‚¯ã‚¹ï¼šã‚¼ãƒ­å¹…æ–‡å­—ã€‚ä¸‹ã®ãƒœãƒƒã‚¯ã‚¹ï¼šãƒã‚¤ãƒŠãƒªå½¢å¼ã€‚',
    mobileAlertMedium: 'æš—å·åŒ–å®Œäº†ã€‚ä¸Šã®ãƒœãƒƒã‚¯ã‚¹ã«ã¯ã‚¼ãƒ­å¹…æ–‡å­—æš—å·åŒ–ã€ä¸‹ã®ãƒœãƒƒã‚¯ã‚¹ã«ã¯ãƒã‚¤ãƒŠãƒªæš—å·åŒ–ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚',
    tranli: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è¨­å®šã«å¾“ã£ã¦è‡ªå‹•çš„ã«ç ´æ£„ã•ã‚Œã¾ã™ã€‚'
  },
  de: {
    encryptTabTitle: 'Zeichen-VerschlÃ¼sselungswerkzeug',
    coverTextLabel: 'Ã–ffentliche Nachricht (Eingabe)',
    coverTextPlaceholder: 'Schreiben Sie Ihre Notiz hier...',
    hiddenTextLabel: 'Geheime Nachricht (Eingabe)',
    hiddenTextPlaceholder: 'Schreiben Sie hier versteckte Nachrichten...',
    encryptKeyLabel: 'Passwort',
    encryptKeyLabelConfirm: 'Passwort bestÃ¤tigen',
    encryptKeyPlaceholder: 'Passwort eingeben',
    encryptKeyPlaceholderConfirm: 'Passwort bestÃ¤tigen',
    pass1Placeholder: 'Passwort eingeben',
    pass2Placeholder: 'Passwort bestÃ¤tigen',
    btnZeroWidthEncrypt: 'Nullbreiten-VerschlÃ¼sselung',
    btnBinaryEncrypt: 'BinÃ¤r-VerschlÃ¼sselung',
    encryptResultLabel: 'Nullbreiten-VerschlÃ¼sselungsergebnis (Zum Teilen kopieren)',
    encryptResultPlaceholder: 'VerschlÃ¼sselter Inhalt wird hier angezeigt',
    binaryResultLabel: 'BinÃ¤r-VerschlÃ¼sselungsergebnis',
    textareaPlaceholder: 'Schreiben Sie Ihre Notiz hier...',
    tranmake: 'Notiz verschlÃ¼sseln',
    btnCopyEncryptResult: 'Nullbreiten-Ergebnis kopieren',
    btnCopyBinaryResult: 'BinÃ¤r-Ergebnis kopieren',
    encryptInfo: '<strong>Info:</strong> Nullbreiten-VerschlÃ¼sselung versteckt den versteckten Inhalt im Decktext. BinÃ¤r-VerschlÃ¼sselung wandelt den versteckten Inhalt in 0/1 um. Sie kÃ¶nnen ein benutzerdefiniertes Passwort festlegen.',
    hiddenTextareaPlaceholder: 'Schreiben Sie hier versteckte Nachrichten...',
    alertPasswordMismatch: 'Passwort stimmt nicht Ã¼berein oder Passwort lÃ¶schen',
    alertContentTooLong: 'Zu lang.....',
    alertWriteSomething: 'Schreiben Sie etwas in die Notiz',
    mobileAlertShort: 'VerschlÃ¼sselung erfolgreich! Oberes Feld: Nullbreitenzeichen. Unteres Feld: BinÃ¤rformat.',
    mobileAlertMedium: 'VerschlÃ¼sselung abgeschlossen. Das obere Feld enthÃ¤lt Nullbreitenzeichen-VerschlÃ¼sselung, wÃ¤hrend das untere BinÃ¤r-VerschlÃ¼sselung zeigt.',
    tranli: 'Die Nachricht wird gemÃ¤ÃŸ Ihren Einstellungen automatisch gelÃ¶scht.'
  }
};

// Initialize current language
let currentLanguage = 'en';

// Helper function to check if localStorage is available
function isLocalStorageAvailable() {
  try {
    const testKey = "__privnote_test__";
    localStorage.setItem(testKey, testKey);
    localStorage.removeItem(testKey);
    return true;
  } catch (e) {
    console.warn("localStorage not available. Language preferences won't be saved.");
    return false;
  }
}

// Load saved language if available
if (isLocalStorageAvailable()) {
  const savedLanguage = localStorage.getItem('privnote_language');
  if (savedLanguage) {
    currentLanguage = savedLanguage;
  }
}

// Helper function to get text based on current language
function getLocalizedString(stringKey, category = 'common') {
  let stringObject;
  
  switch(category) {
    case 'encryption':
      stringObject = languageEncryptionStrings[currentLanguage] || languageEncryptionStrings['en'];
      break;
    case 'common':
    default:
      stringObject = languageCommonStrings[currentLanguage] || languageCommonStrings['en'];
      break;
  }
  
  return stringObject[stringKey] || stringKey;
}

// Update user interface with the selected language
function applyLanguage(lang) {
  const commonStrings = languageCommonStrings[lang] || languageCommonStrings['en'];
  const encryptionStrings = languageEncryptionStrings[lang] || languageEncryptionStrings['en'];
  
  // Update common elements with flag icons
  if (lang === 'en') document.getElementById('currentLanguage').textContent = 'ğŸ‡ºğŸ‡¸ English';
  else if (lang === 'zh') document.getElementById('currentLanguage').textContent = 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡';
  else if (lang === 'tw') document.getElementById('currentLanguage').textContent = 'ğŸ‡¹ğŸ‡¼ ä¸­æ–‡';
  else if (lang === 'es') document.getElementById('currentLanguage').textContent = 'ğŸ‡ªğŸ‡¸ EspaÃ±ol';
  else if (lang === 'fr') document.getElementById('currentLanguage').textContent = 'ğŸ‡«ğŸ‡· FranÃ§ais';
  else if (lang === 'ja') document.getElementById('currentLanguage').textContent = 'ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª';
  else if (lang === 'de') document.getElementById('currentLanguage').textContent = 'ğŸ‡©ğŸ‡ª Deutsch';
  
  document.getElementById('trans1').textContent = commonStrings.tagline;
  document.getElementById('navLinkText').textContent = commonStrings.navLinkText;
  document.getElementById('navEncryptText').textContent = commonStrings.navEncryptText;
  document.getElementById('navDecryptText').textContent = commonStrings.navDecryptText;
  
  // Update encryption page elements
  document.getElementById('encryptTabTitle').textContent = encryptionStrings.encryptTabTitle;
  document.querySelector('label[for="myTextarea"]').innerHTML = '<i class="fas fa-edit me-1"></i>' + encryptionStrings.coverTextLabel;
  document.querySelector('label[for="HiddenTextarea"]').innerHTML = '<i class="fas fa-eye-slash me-1"></i>' + encryptionStrings.hiddenTextLabel;
  document.querySelector('label[for="pass1"]').textContent = encryptionStrings.encryptKeyLabel;
  document.querySelector('label[for="pass2"]').textContent = encryptionStrings.encryptKeyLabelConfirm;
  document.querySelector('label[for="coverCopy"]').innerHTML = '<i class="fas fa-key me-1"></i>' + encryptionStrings.encryptResultLabel;
  
  // Update placeholders
  document.getElementById('myTextarea').placeholder = encryptionStrings.textareaPlaceholder;
  document.getElementById('HiddenTextarea').placeholder = encryptionStrings.hiddenTextareaPlaceholder;
  document.getElementById('pass1').placeholder = encryptionStrings.pass1Placeholder;
  document.getElementById('pass2').placeholder = encryptionStrings.pass2Placeholder;
  document.getElementById('coverCopy').placeholder = encryptionStrings.encryptResultPlaceholder;
  
  // Update buttons
  document.getElementById('tranmake').innerHTML = '<i class="fas fa-lock me-2"></i>' + encryptionStrings.tranmake;
  document.querySelector('.btn-danger').innerHTML = '<i class="fas fa-copy me-2"></i>' + encryptionStrings.btnCopyEncryptResult;
  
  // Update other elements
  if (document.getElementById('tranli')) {
    document.getElementById('tranli').textContent = encryptionStrings.tranli;
  }
  
  // Update success message for mobile if displayed
  const successSpan = document.querySelector('#encryptinfo span');
  if (successSpan) {
    if (window.innerWidth < 576) {
      successSpan.textContent = encryptionStrings.mobileAlertShort;
    } else if (window.innerWidth < 768) {
      successSpan.textContent = encryptionStrings.mobileAlertMedium;
    }
  }
  
  // Visual indication in dropdown
  document.querySelectorAll('.dropdown-item').forEach(item => {
    item.classList.remove('active');
    if (item.getAttribute('onclick') && item.getAttribute('onclick').includes(`'${lang}'`)) {
      item.classList.add('active');
    }
  });
}

// Main function to switch language
function switchLanguage(lang) {
  currentLanguage = lang;
  
  // Save to localStorage if available
  if (isLocalStorageAvailable()) {
    localStorage.setItem('privnote_language', lang);
  }
  
  // Apply the language to the UI
  applyLanguage(lang);
}

// =======================================================================
// 2. ENCRYPTION AND DECRYPTION FUNCTIONS 
// =======================================================================

// åŠ å¯†è¿‡ç¨‹ï¼šä½¿ç”¨XORå¯¹æ–‡æœ¬è¿›è¡ŒåŠ å¯†ï¼Œå¹¶è½¬æ¢ä¸º0å’Œ1çš„äºŒè¿›åˆ¶
function textToBinaryEncryption(text, key) {
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));  // è½¬æ¢å¯†é’¥ä¸ºå­—ç¬¦çš„charCodeæ•°ç»„

    // ç¬¬ä¸€æ­¥ï¼šå¯¹æ¯ä¸ªå­—ç¬¦è¿›è¡ŒXORåŠ å¯†ï¼Œå¹¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶
    const encryptedText = Array.from(text).map((char, index) => {
        // ä½¿ç”¨å¯†é’¥å­—ç¬¦çš„charCodeä¸å½“å‰å­—ç¬¦çš„charCodeè¿›è¡Œå¼‚æˆ–è¿ç®—
        let charCode = char.charCodeAt(0) ^ keyCodes[index % keyCodes.length];
        
        // è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œè¿”å›çš„æ˜¯0å’Œ1çš„å­—ç¬¦ä¸²ï¼ˆæ¯ä¸ªå­—ç¬¦çš„16ä½äºŒè¿›åˆ¶è¡¨ç¤ºï¼‰
        return charCode.toString(2).padStart(16, '0'); // æ¯ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º16ä½
    }).join('');

    return encryptedText;
}

// è§£å¯†è¿‡ç¨‹ï¼šä»0å’Œ1çš„äºŒè¿›åˆ¶æ¢å¤åŸå§‹æ–‡æœ¬
function binaryToTextDecryption(binaryText, key) {
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));  // è½¬æ¢å¯†é’¥ä¸ºå­—ç¬¦çš„charCodeæ•°ç»„

    // åˆ†å‰²äºŒè¿›åˆ¶å­—ç¬¦ä¸²ä¸ºæ¯16ä½ä¸€ç»„ï¼ˆæ¯ä¸ªå­—ç¬¦çš„16ä½äºŒè¿›åˆ¶è¡¨ç¤ºï¼‰
    const text = binaryText.match(/.{16}/g).map((bin, index) => {
        // å°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸ºæ•´æ•°ï¼ˆå­—ç¬¦ç¼–ç ï¼‰ï¼Œå¹¶è¿›è¡ŒXORè§£å¯†
        let charCode = parseInt(bin, 2) ^ keyCodes[index % keyCodes.length];
        return String.fromCharCode(charCode);
    }).join('');

    return text;
}

// ä½¿ç”¨ç»Ÿä¸€çš„ 16 ä½äºŒè¿›åˆ¶è¿›è¡Œ XOR åŠ å¯†ï¼Œå¹¶è½¬æ¢ä¸ºé›¶å®½å­—ç¬¦
function textToZeroWidthWithDoubleEncryption(text, key) {
    // å°†å¯†é’¥å­—ç¬¦ä¸²è½¬ä¸ºå­—ç¬¦çš„ charCode æ•°ç»„
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));

    // ç¬¬ä¸€æ­¥ï¼šXOR åŠ å¯†
    const xorEncryptedText = Array.from(text).map((char, index) => {
        // ä½¿ç”¨ keyCodes ä¸­çš„å­—ç¬¦ä¸åŸå§‹å­—ç¬¦çš„ charCode è¿›è¡Œå¼‚æˆ–è¿ç®—
        let charCode = char.charCodeAt(0) ^ keyCodes[index % keyCodes.length];
        
        // å°†å­—ç¬¦ç¼–ç å¼ºåˆ¶ä¸º 16 ä½äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œç¡®ä¿ç»Ÿä¸€é•¿åº¦
        return charCode.toString(2).padStart(16, '0');
    }).join('');

    // ç¬¬äºŒæ­¥ï¼šå°† XOR åŠ å¯†åçš„äºŒè¿›åˆ¶è½¬æ¢ä¸ºé›¶å®½å­—ç¬¦
    return xorEncryptedText.split('').map(bit => bit === '0' ? '\u200B' : '\u200C').join('');
}

// è§£å¯†æµç¨‹ï¼šå…ˆè§£ç é›¶å®½å­—ç¬¦ï¼Œå†ä½¿ç”¨ XOR è§£å¯†
function zeroWidthToTextWithDoubleDecryption(zeroWidthText, key) {
    // å°†å¯†é’¥å­—ç¬¦ä¸²è½¬ä¸ºå­—ç¬¦çš„ charCode æ•°ç»„
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));

    // å°†é›¶å®½å­—ç¬¦è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
    const binary = Array.from(zeroWidthText).map(char => {
        return char === '\u200B' ? '0' : '1';
    }).join('');

    // æ¯16ä¸ªäºŒè¿›åˆ¶ä½æ¢å¤ä¸ºä¸€ä¸ªå­—ç¬¦
    const text = binary.match(/.{16}/g).map((bin, index) => {
        let charCode = parseInt(bin, 2) ^ keyCodes[index % keyCodes.length];
        return String.fromCharCode(charCode);
    }).join('');

    // æ£€æŸ¥å¹¶æ›¿æ¢æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯éæ³•å­—ç¬¦ï¼ˆå¦‚åŠè§’å­—ç¬¦ï¼‰
    if (text.charCodeAt(text.length - 1) < 32 || text.charCodeAt(text.length - 1) > 126) {
        // å¦‚æœæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯éæ³•å­—ç¬¦ï¼ˆå¦‚æ¢è¡Œç¬¦ã€å›è½¦ç¬¦ï¼‰ï¼Œå°±æ›¿æ¢ä¸ºç©ºæ ¼
        return text.slice(0, -1) + ' ';
    }
    return text;
}

// =======================================================================
// 3. UI INTERACTION FUNCTIONS
// =======================================================================

// Copy text from textarea to clipboard
function copyTextarea(id) {
    var textarea = document.getElementById(id);
    textarea.select();
    document.execCommand('copy');
    
    // Visual feedback for copy
    let button;
    if (id === 'coverCopy') {
        // ç›´æ¥æ‰¾åˆ°æŒ‰é’®è€Œä¸æ˜¯ä½¿ç”¨ nextElementSibling
        button = document.querySelector('.btn-danger[onclick="copyTextarea(\'coverCopy\')"]');
    } else {
        // äºŒè¿›åˆ¶ç»“æœçš„æŒ‰é’®ï¼Œå› ä¸ºæ˜¯åŠ¨æ€åˆ›å»ºçš„ï¼Œä½¿ç”¨éƒ¨åˆ†åŒ¹é…
        button = document.querySelector('.btn-info[onclick*="' + id + '"]');
    }
    
    if (button) {
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check me-2"></i>Copied!';
        
        setTimeout(() => {
            button.innerHTML = originalText;
        }, 2000);
    }
}

// Copy link from innerlink element
function copylink() {
     const exampleLi = document.getElementById('innerlink');
     const exampleText = exampleLi.textContent;
     navigator.clipboard.writeText(exampleText)
  .then(() => {
    var button = document.getElementById("copybutton");
    button.classList.add('rotate');
    button.textContent = "Link Copied";
  })
  .catch((err) => {
    console.error('Error copying text: ', err);
  });
}

// Simulate typing effect for text display
function simulateTyping(elementId, text, speed) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    element.value = '';
    let i = 0;
    
    function type() {
        if (i < text.length) {
            element.value += text.charAt(i);
            i++;
            setTimeout(type, speed);
        }
    }
    
    type();
}

// Main function to create encrypted content
function create() {
   const textarea = document.getElementById('myTextarea');
   textareaValue = textarea.value; 
   const hiddentext = document.getElementById('HiddenTextarea');
   hiddentextValue = hiddentext.value; hiddentextValue += ' \n ';
  let totallength = textareaValue.length + hiddentextValue.length;

  if(totallength > 30000){
    alert(getLocalizedString('alertContentTooLong', 'encryption'));
    return;
  }

  if (textareaValue === ""){
    alert(getLocalizedString('alertWriteSomething', 'encryption'));
    return;
  }

   pass1 = document.getElementById('pass1').value;
   pass2 = document.getElementById('pass2').value;
   
  if (pass1 === "" && pass2 === "") {
    pass1 = 'mythenigma';  
  } else if (pass1 === pass2) {
    pass1 = pass2;
  } else {
    alert(getLocalizedString('alertPasswordMismatch', 'encryption'));
    return;
  }

 const encodedSecretMessage = textToZeroWidthWithDoubleEncryption(hiddentextValue, pass1);
 const encodedSecretMessage01= textToBinaryEncryption(hiddentextValue, pass1); 
 combineallvalue =  encodedSecretMessage + textareaValue;
 textareaValue   =  combineallvalue;
 textarea.value  =  combineallvalue;
 hiddentext.value=   encodedSecretMessage01;
 
 // Show the result
 document.getElementById('encryptinfo').style.display = 'block';
 document.getElementById('coverCopy').value = textarea.value;
 
 // å°†HiddenTextæ¡†ç§»åŠ¨åˆ°æœ€ä¸‹é¢
 const hiddenTextContainer = document.getElementById('hiddenTextContainer');
 const hiddenTextAfterEncrypt = document.getElementById('hiddenTextAfterEncrypt');
 const hiddenTextArea = document.getElementById('HiddenTextarea');
 
 // ä¿®æ”¹æ ‡ç­¾æ–‡æœ¬ï¼Œæ›´æ¸…æ™°åœ°è¡¨ç¤ºè¿™æ˜¯äºŒè¿›åˆ¶åŠ å¯†ç»“æœ
 const label = hiddenTextContainer.querySelector('label');
 label.innerHTML = '<i class="fas fa-code me-1"></i>' + getLocalizedString('binaryResultLabel', 'encryption');
 
 // ä»çˆ¶å…ƒç´ ä¸­ç§»é™¤åŸå§‹ textarea
 const hiddenTextParent = hiddenTextArea.parentNode;
 hiddenTextParent.removeChild(hiddenTextArea);
 
 // ç»™äºŒè¿›åˆ¶ç»“æœæ¡†æ·»åŠ å·¦è¾¹æ¡†æ ·å¼ - ä½¿ç”¨è“è‰²
 hiddenTextArea.style.borderLeft = '4px solid #17a2b8';
 hiddenTextArea.style.background = 'linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9))';
 hiddenTextArea.className = 'form-control mb-2'; // æ·»åŠ  mb-2 ä»¥åœ¨æ–‡æœ¬æ¡†å’ŒæŒ‰é’®ä¹‹é—´åˆ›å»ºé—´è·
 
 // å°†åŸå§‹ textarea æ·»åŠ å›çˆ¶å®¹å™¨
 hiddenTextParent.appendChild(hiddenTextArea);
 
 // æ˜¾ç¤ºç»“æœ
 document.getElementById('coverCopy').style.borderLeft = '4px solid #dc3545';
 document.getElementById('coverCopy').style.background = 'linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9))';
 
 // åˆ›å»ºå¤åˆ¶æŒ‰é’®å¹¶æ·»åŠ åˆ°æ–‡æœ¬æ¡†ä¸‹æ–¹
 const copyButton = document.createElement('button');
 copyButton.className = 'btn btn-info';  // ä½¿ç”¨è“è‰²æŒ‰é’®(info)ï¼ŒåŒºåˆ«äºä¸Šé¢çš„çº¢è‰²æŒ‰é’®(danger)
 copyButton.type = 'button';
 copyButton.innerHTML = '<i class="fas fa-copy me-2"></i>' + getLocalizedString('btnCopyBinaryResult', 'encryption');
 copyButton.onclick = function() { copyTextarea('HiddenTextarea'); };
 copyButton.style.width = 'auto'; // è®¾ç½®æŒ‰é’®å®½åº¦ä¸ºè‡ªåŠ¨
 copyButton.style.display = 'block'; // è®¾ç½®ä¸ºå—çº§å…ƒç´ 
 
 // åˆ›å»ºä¸€ä¸ªæŒ‰é’®å®¹å™¨ï¼Œç”¨äºå±…ä¸­æ˜¾ç¤ºæŒ‰é’®
 const buttonContainer = document.createElement('div');
 buttonContainer.className = 'd-flex justify-content-center';
 buttonContainer.appendChild(copyButton);
 
 // å°†æŒ‰é’®å®¹å™¨æ·»åŠ åˆ°çˆ¶å®¹å™¨
 hiddenTextParent.appendChild(buttonContainer);
 
 // ä»åŸä½ç½®ç§»é™¤å¹¶é™„åŠ åˆ°åº•éƒ¨å®¹å™¨
 hiddenTextAfterEncrypt.appendChild(hiddenTextContainer);
 
 // æ·»åŠ ä¸€äº›é¡¶éƒ¨é—´è·ï¼Œä½¿å…¶ä¸ä¸Šé¢çš„å†…å®¹æœ‰æ›´å¥½çš„è§†è§‰åˆ†éš”
 hiddenTextContainer.classList.add('mt-4');
 
 // æ›´æ–°æˆåŠŸæ¶ˆæ¯æ–‡æœ¬æ ¹æ®å±å¹•å°ºå¯¸
 updateSuccessMessage();
}

// Update success message based on screen size
function updateSuccessMessage() {
  const alertSpan = document.querySelector('#encryptinfo span');
  if (alertSpan) {
    if (window.innerWidth < 576) {
      alertSpan.textContent = getLocalizedString('mobileAlertShort', 'encryption');
    } else if (window.innerWidth < 768) {
      alertSpan.textContent = getLocalizedString('mobileAlertMedium', 'encryption');
    }
  }
}

// Handle screen size changes for mobile optimization
function adjustForMobileView() {
  if (window.innerWidth < 768) {
    // Adjust textarea rows for better mobile viewing
    document.querySelectorAll('textarea').forEach(textarea => {
      textarea.rows = 4;
    });
    
    // Update success message if visible
    updateSuccessMessage();
    
    // Adjust button text for smaller screens
    const copyZeroWidthBtn = document.querySelector('.btn-danger[onclick="copyTextarea(\'coverCopy\')"]');
    if (copyZeroWidthBtn && window.innerWidth < 400) {
      copyZeroWidthBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Copy';
    }
  }
}

// Call the function on page load and resize
window.addEventListener('load', adjustForMobileView);
window.addEventListener('resize', adjustForMobileView);

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  console.log("DOM fully loaded, initializing UI...");
  
  // Apply current language from localStorage or default
  applyLanguage(currentLanguage);
  
  // Override create function for mobile displays
  const originalCreate = create;
  create = function() {
    originalCreate();
    
    // After encryption, if on mobile, modify the dynamically created button text to be shorter
    if (window.innerWidth < 400) {
      const binaryResultBtn = document.querySelector('.btn-info[onclick*="HiddenTextarea"]');
      if (binaryResultBtn) {
        binaryResultBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Copy';
      }
    }
    
    // Scroll to the results on mobile
    if (window.innerWidth < 768) {
      document.getElementById('encryptinfo').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
  };
});

// Variables for encryption functions
var textareaValue = '';
var expiretime = 0;
var confirmask = 1;
var pass1 = '';
var pass2 = '';
var myArray = '';
var lastElement = '';
var globename = '';
var combineallvalue = '';
</script>

</body>
</html>
