<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>Privnote - Character Encryption</title>
<meta name="keywords" content="zero-width character encryption, binary encryption, secure messaging, encrypted notes, ephemeral messages,隐信云">
<meta name="description" content="Privnote.chat allows you to encrypt messages using zero-width characters and binary formats, ensuring secure and private messaging.">
<meta property="og:image" content="privnote.png">
<meta property="og:url" content="https://privnote.chat/encryption.html">
<link rel="canonical" href="https://privnote.chat/encryption.html">
<meta property="og:type" content="website">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap & Font Awesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9224406325142860" crossorigin="anonymous"></script>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "Organization",
"name": "Privnote",
"url": "https://privnote.chat",
"logo": "https://privnote.chat/read/pic/noti.png",
"contactPoint": {
"@type": "ContactPoint",
"email": "contact@privnote.chat",
"contactType": "customer service"
}
}
</script>

<style>
/* Enhanced Mobile Header Styles */
@media (max-width: 767px) {
  .site-header {
    padding: 10px 5px;
    background-color: #343a40;
  }
  .logo-text {
    font-size: 1.3rem;
    margin-bottom: 0;
    white-space: nowrap;
  }
  .logo-container {
    display: flex;
    align-items: center;
  }
  .logo-icon {
    color: #FFC107;
    font-size: 1.3rem;
    margin-right: 3px;
  }
  .language-dropdown {
    margin-right: 5px;
  }
  .language-dropdown .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
  }
  .tagline {
    display: none;
  }
  .mobile-tagline {
    display: block;
    text-align: center;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.8);
    margin-top: 5px;
    font-style: italic;
  }
  .header-row {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  .header-controls {
    display: flex;
    align-items: center;
  }
  
  /* Improved mobile navigation */
  #mainNav {
    overflow-x: auto;
    flex-wrap: nowrap;
    padding-bottom: 2px;
    max-width: 100%;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }
  #mainNav::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  #mainNav .nav-link {
    padding: 0.4rem 0.6rem;
    white-space: nowrap;
    font-size: 0.9rem;
  }
  
  /* Improved form controls for mobile */
  .main-container {
    padding: 0 8px;
  }
  .form-label {
    font-size: 0.85rem;
    margin-bottom: 0.2rem;
  }
  textarea.form-control {
    font-size: 0.9rem;
    padding: 0.4rem;
  }
  .btn {
    padding: 0.35rem 0.65rem;
    font-size: 0.9rem;
  }
  
  /* Improved alert and card styling */
  .alert {
    padding: 0.6rem;
    font-size: 0.85rem;
  }
  .card-body {
    padding: 0.75rem;
  }
  
  /* Fix dropdown on mobile */
  .dropdown-menu {
    position: absolute;
    min-width: 7rem;
  }
}

/* Extra small devices (phones, 576px and down) */
@media (max-width: 576px) {
  .site-header {
    padding: 8px 4px;
  }
  .logo-text {
    font-size: 1.2rem;
  }
  .logo-icon {
    font-size: 1.2rem;
  }
  #mainNav .nav-link {
    padding: 0.35rem 0.5rem;
    font-size: 0.85rem;
  }
  h5.mb-3 {
    font-size: 1.1rem;
    margin-bottom: 0.5rem !important;
  }
  .form-label {
    font-size: 0.8rem;
  }
  .row.mb-3 {
    margin-bottom: 0.5rem !important;
  }
  textarea.form-control, input.form-control {
    font-size: 0.85rem;
    padding: 0.35rem;
  }
  .btn {
    font-size: 0.85rem;
    padding: 0.3rem 0.6rem;
  }
}

@media (min-width: 768px) {
  .mobile-tagline {
    display: none;
  }
}

/* Add button hover/active states for better mobile feedback */
.btn:active {
  transform: translateY(1px);
}

/* Ensure scrolling works properly on mobile */
body {
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Fix modal display on mobile */
.modal-dialog {
  margin: 0.5rem;
}
@media (max-width: 576px) {
  .modal-dialog {
    max-width: 95%;
    margin: 0.25rem auto;
  }
  .modal-body {
    padding: 0.5rem;
  }
  .modal-footer, .modal-header {
    padding: 0.5rem;
  }
}

/* Dropdown styling for language selector */
.dropdown-item.active {
  background-color: #f8f9fa;
  color: #007bff;
  font-weight: bold;
}
.dropdown-item.active::before {
  content: "✓ ";
}
</style>

</head>

<body class="d-flex flex-column min-vh-100">
<header class="site-header">
<div class="container-fluid d-flex justify-content-between align-items-center">
<a class="text-decoration-none" href="https://privnote.chat">
<h1 class="logo-text">Priv<i class="fas fa-unlock-alt"></i>ote.chat</h1>
</a>
<div class="d-flex align-items-center">
<div class="dropdown me-3">
<button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
<span id="currentLanguage">English</span>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
<li><a class="dropdown-item" href="#" onclick="switchLanguage('en')">🇺🇸 English</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('zh')">🇨🇳 中文</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('tw')">🇹🇼 中文</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('es')">🇪🇸 Español</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('fr')">🇫🇷 Français</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('ja')">🇯🇵 日本語</a></li>
<li><a class="dropdown-item" href="#" onclick="switchLanguage('de')">🇩🇪 Deutsch</a></li>
</ul>
</div>
<div id="trans1" class="tagline">Secure your words, vanish your trace</div>
</div>
</div>
</header>

<!-- Navigation Links -->
<div class="container">
  <ul class="nav nav-tabs justify-content-center mb-4" id="mainNav">
    <li class="nav-item">
      <a class="nav-link" href="index.html">
        <span id="navLinkText">Generate Link</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link active" href="encryption.html">
        <span id="navEncryptText">Character Encryption</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="decrypt.html">
        <span id="navDecryptText">Decrypt</span>
      </a>
    </li>
  </ul>
</div>

<main class="flex-grow-1">
<div class="container main-container">
    <h5 class="mb-3 mt-4 pt-2 text-center" id="encryptTabTitle">Character Encryption Tool</h5>

    <!-- First textarea - Input area -->
    <div class="mb-3">
      <label for="myTextarea" class="form-label"><i class="fas fa-edit me-1"></i>Public Message (Input)</label>
      <textarea class="form-control" id="myTextarea" rows="5" placeholder="Write Your Note Here..." style="border-left: 4px solid #3498db;"></textarea>
    </div>
    
    <!-- Hidden textarea - will be moved to bottom after encryption -->
    <div class="mb-3" id="hiddenTextContainer">
      <label for="HiddenTextarea" class="form-label"><i class="fas fa-eye-slash me-1"></i>Secret Message (Input)</label>
      <textarea class="form-control" id="HiddenTextarea" rows="5" placeholder="Write Hidden Messages Here..." style="border-left: 4px solid #9b59b6;"></textarea>
    </div>

    <!-- Password inputs -->
    <div class="row mb-3">
      <div class="col-md-6 mb-2 mb-md-0">
        <label for="pass1" class="form-label">Password</label>
        <input type="password" class="form-control" id="pass1" placeholder="Enter Password" autocomplete="off" required>
      </div>
      <div class="col-md-6">
        <label for="pass2" class="form-label">Confirm Password</label>
        <input type="password" class="form-control" id="pass2" placeholder="Confirm Password" required>
      </div>
    </div>

    <!-- Encrypt button -->
    <div class="d-grid gap-2 d-md-flex justify-content-md-center mb-4">
      <button id="tranmake" type="button" class="btn btn-warning px-4 py-2" onclick="create()">
        <i class="fas fa-lock me-2"></i>Encrypt Note
      </button>
    </div>

    <!-- Result display area -->
    <div class="alert alert-success" id="encryptinfo" style="display: none">
      <strong>Success!</strong> <span>The note has been successfully encrypted with two methods: the upper box contains zero-width character encryption, storing the information within the text, while the lower box shows the encryption as binary (0s and 1s). Both can be copied and used for decryption.</span>
    </div>

    <!-- Cover text copy area - 使用红色主题 -->
    <div class="mb-3">
      <label for="coverCopy" class="form-label"><i class="fas fa-key me-1"></i>Zero-Width Encrypted Result (Copy to Share)</label>
      <textarea class="form-control mb-2" id="coverCopy" rows="5" placeholder="Encrypted content will appear here" readonly style="border-left: 4px solid #dc3545; background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9)) !important;"></textarea>
      <div class="d-flex justify-content-center">
        <button class="btn btn-danger" type="button" onclick="copyTextarea('coverCopy')">
          <i class="fas fa-copy me-2"></i>Copy Zero-Width Result
        </button>
      </div>
    </div>

    <!-- Card for link generation -->
    <div class="card" id="resultlink" style="display: none">
      <div class="card-body">
        <h6 class="card-title">PrivNote has been made</h6>
        <ul class="list-group list-group-flush mb-3">
          <li class="list-group-item list-group-item-success" id="innerlink"></li>
          <li id="tranli" class="list-group-item list-group-item-warning">The message will be automatically destroyed according to your settings.</li>
        </ul>
        <button type="button" class="btn btn-outline-secondary" id="copybutton" onclick="copylink()">
          <i class="fas fa-copy me-2"></i>Copy Link
        </button>
      </div>
    </div>
    
    <!-- Container for Hidden Text after encryption -->
    <div id="hiddenTextAfterEncrypt"></div>
</div>
</main>

<footer class="mt-auto">
<div class="container">
  <div class="text-center mb-3" id="blog-bottom-link">
    <a href="blog/index.html" class="btn btn-outline-primary"><i class="fas fa-blog me-2"></i>Blog</a>
  </div>
<p class="text-center mb-0">
<a href="read/selfdestructANDencoding.php" class="nav-link">
&copy;2025 MaiPDF.com<br><span class="__cf_email__" data-cfemail="b7ddd8d2f7c7d3d1dfd8c4c399d8d9dbded9d2">[email&#160;protected]</span>
</a>
</p>
</div>
</footer>

<div class="modal fade" id="myModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">How to decode messages</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <img id="decrysrc" src="read/pic/enDecode1.png" class="img-fluid" alt="changecode">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>

<!-- All JavaScript in one place, no external dependencies -->
<script>
// =======================================================================
// 1. TRANSLATION STRINGS AND LANGUAGE SWITCHING FUNCTIONALITY
// =======================================================================

// Common language strings for main pages
const languageCommonStrings = {
  en: {
    tagline: 'Secure your words, vanish your trace',
    navLinkText: 'Generate Link',
    navEncryptText: 'Character Encryption',
    navDecryptText: 'Decrypt',
    currentLanguage: 'English'
  },
  zh: {
    tagline: '安全传信，隐匿无踪',
    navLinkText: '生成链接',
    navEncryptText: '字符加密',
    navDecryptText: '解密工具',
    currentLanguage: '中文'
  },
  tw: {
    tagline: '安全傳信，隱匿無蹤',
    navLinkText: '生成連結',
    navEncryptText: '字元加密',
    navDecryptText: '解密工具',
    currentLanguage: '中文'
  },
  es: {
    tagline: 'Asegura tus palabras, desvanece tu rastro',
    navLinkText: 'Generar Enlace',
    navEncryptText: 'Cifrado de Caracteres',
    navDecryptText: 'Descifrar',
    currentLanguage: 'Español'
  },
  fr: {
    tagline: 'Sécurisez vos mots, faites disparaître votre trace',
    navLinkText: 'Générer un Lien',
    navEncryptText: 'Chiffrement de Caractères',
    navDecryptText: 'Déchiffrer',
    currentLanguage: 'Français'
  },
  ja: {
    tagline: 'あなたの言葉を守り、痕跡を消す',
    navLinkText: 'リンクを生成',
    navEncryptText: '文字の暗号化',
    navDecryptText: '復号',
    currentLanguage: '日本語'
  },
  de: {
    tagline: 'Sichern Sie Ihre Worte, verschwinden Sie Ihre Spur',
    navLinkText: 'Link generieren',
    navEncryptText: 'Zeichenverschlüsselung',
    navDecryptText: 'Entschlüsseln',
    currentLanguage: 'Deutsch'
  }
};

// Encryption page specific strings
const languageEncryptionStrings = {
  en: {
    encryptTabTitle: 'Character Encryption Tool',
    coverTextLabel: 'Public Message (Input)',
    coverTextPlaceholder: 'Write Your Note Here...',
    hiddenTextLabel: 'Secret Message (Input)',
    hiddenTextPlaceholder: 'Write Hidden Messages Here...',
    encryptKeyLabel: 'Password',
    encryptKeyLabelConfirm: 'Confirm Password',
    encryptKeyPlaceholder: 'Enter Password',
    encryptKeyPlaceholderConfirm: 'Confirm Password',
    pass1Placeholder: 'Enter Password',
    pass2Placeholder: 'Confirm Password',
    btnZeroWidthEncrypt: 'Zero-Width Encrypt',
    btnBinaryEncrypt: 'Binary Encrypt',
    encryptResultLabel: 'Zero-Width Encrypted Result (Copy to Share)',
    encryptResultPlaceholder: 'Encrypted content will appear here',
    binaryResultLabel: 'Binary Encryption Result',
    textareaPlaceholder: 'Write Your Note Here...',
    tranmake: 'Encrypt Note',
    btnCopyEncryptResult: 'Copy Zero-Width Result',
    btnCopyBinaryResult: 'Copy Binary Result',
    encryptInfo: '<strong>Info:</strong> Zero-width encryption hides the hidden content in the cover text. Binary encryption converts the hidden content to 0/1. You can set a custom password.',
    hiddenTextareaPlaceholder: 'Write Hidden Messages Here...',
    alertPasswordMismatch: 'Password does not match or clear password',
    alertContentTooLong: 'Too long.....',
    alertWriteSomething: 'Write something on note',
    mobileAlertShort: 'Encryption successful! Upper box: zero-width characters. Lower box: binary format.',
    mobileAlertMedium: 'Encryption complete. The top box contains zero-width character encryption, while the bottom shows binary encryption.',
    tranli: 'The message will be automatically destroyed according to your settings.'
  },
  zh: {
    encryptTabTitle: '字符加密工具',
    coverTextLabel: '表面内容（输入）',
    coverTextPlaceholder: '在此输入便签内容...',
    hiddenTextLabel: '隐藏内容（输入）',
    hiddenTextPlaceholder: '在此输入隐藏内容...',
    encryptKeyLabel: '密码',
    encryptKeyLabelConfirm: '确认密码',
    encryptKeyPlaceholder: '输入密码',
    encryptKeyPlaceholderConfirm: '确认密码',
    pass1Placeholder: '输入密码',
    pass2Placeholder: '确认密码',
    btnZeroWidthEncrypt: '零宽字符加密',
    btnBinaryEncrypt: '二进制加密',
    encryptResultLabel: '零宽字符加密结果（复制分享）',
    encryptResultPlaceholder: '加密内容将在此显示',
    binaryResultLabel: '二进制加密结果',
    textareaPlaceholder: '在此输入便签内容...',
    tranmake: '加密便签',
    btnCopyEncryptResult: '复制零宽字符结果',
    btnCopyBinaryResult: '复制二进制结果',
    encryptInfo: '<strong>说明：</strong>零宽字符加密会将隐藏内容隐写进表面内容，二进制加密则将隐藏内容转为0/1字符串。可自定义密码。',
    hiddenTextareaPlaceholder: '在此输入隐藏内容...',
    alertPasswordMismatch: '密码不匹配或清除密码',
    alertContentTooLong: '内容过长.....',
    alertWriteSomething: '请在便签上写些内容',
    mobileAlertShort: '加密成功！上框：零宽字符。下框：二进制格式。',
    mobileAlertMedium: '加密完成。顶部框包含零宽字符加密，底部显示二进制加密。',
    tranli: '消息将根据您的设置自动销毁。'
  },
  tw: {
    encryptTabTitle: '字元加密工具',
    coverTextLabel: '表面內容（輸入）',
    coverTextPlaceholder: '在此輸入便條內容...',
    hiddenTextLabel: '隱藏內容（輸入）',
    hiddenTextPlaceholder: '在此輸入隱藏內容...',
    encryptKeyLabel: '密碼',
    encryptKeyLabelConfirm: '確認密碼',
    encryptKeyPlaceholder: '輸入密碼',
    encryptKeyPlaceholderConfirm: '確認密碼',
    pass1Placeholder: '輸入密碼',
    pass2Placeholder: '確認密碼',
    btnZeroWidthEncrypt: '零寬字元加密',
    btnBinaryEncrypt: '二進位加密',
    encryptResultLabel: '零寬字元加密結果（複製分享）',
    encryptResultPlaceholder: '加密內容將顯示在此',
    binaryResultLabel: '二進位加密結果',
    textareaPlaceholder: '在此輸入便條內容...',
    tranmake: '加密便條',
    btnCopyEncryptResult: '複製零寬字元結果',
    btnCopyBinaryResult: '複製二進位結果',
    encryptInfo: '<strong>說明：</strong>零寬字元加密會將隱藏內容隱寫進表面內容，二進位加密則將隱藏內容轉為0/1字串。可自訂密碼。',
    hiddenTextareaPlaceholder: '在此輸入隱藏內容...',
    alertPasswordMismatch: '密碼不匹配或清除密碼',
    alertContentTooLong: '內容過長.....',
    alertWriteSomething: '請在便條上寫些內容',
    mobileAlertShort: '加密成功！上框：零寬字元。下框：二進位格式。',
    mobileAlertMedium: '加密完成。上框包含零寬字元加密，下框顯示二進位加密。',
    tranli: '訊息將依據您的設定自動銷毀。'
  },
  es: {
    encryptTabTitle: 'Herramienta de Cifrado de Caracteres',
    coverTextLabel: 'Mensaje Público (Entrada)',
    coverTextPlaceholder: 'Escriba su nota aquí...',
    hiddenTextLabel: 'Mensaje Secreto (Entrada)',
    hiddenTextPlaceholder: 'Escriba mensajes ocultos aquí...',
    encryptKeyLabel: 'Contraseña',
    encryptKeyLabelConfirm: 'Confirmar Contraseña',
    encryptKeyPlaceholder: 'Ingrese contraseña',
    encryptKeyPlaceholderConfirm: 'Confirme contraseña',
    pass1Placeholder: 'Ingrese contraseña',
    pass2Placeholder: 'Confirme contraseña',
    btnZeroWidthEncrypt: 'Cifrado de Ancho Cero',
    btnBinaryEncrypt: 'Cifrado Binario',
    encryptResultLabel: 'Resultado Cifrado de Ancho Cero (Copiar para Compartir)',
    encryptResultPlaceholder: 'El contenido cifrado aparecerá aquí',
    binaryResultLabel: 'Resultado de Cifrado Binario',
    textareaPlaceholder: 'Escriba su nota aquí...',
    tranmake: 'Cifrar Nota',
    btnCopyEncryptResult: 'Copiar Resultado de Ancho Cero',
    btnCopyBinaryResult: 'Copiar Resultado Binario',
    encryptInfo: '<strong>Info:</strong> El cifrado de ancho cero oculta el contenido en el texto de cobertura. El cifrado binario convierte el contenido oculto a 0/1. Puede establecer una contraseña personalizada.',
    hiddenTextareaPlaceholder: 'Escriba mensajes ocultos aquí...',
    alertPasswordMismatch: 'Contraseña no coincidente o borrar la contraseña',
    alertContentTooLong: 'Demasiado largo.....',
    alertWriteSomething: 'Escriba algo en la nota',
    mobileAlertShort: '¡Cifrado exitoso! Cuadro superior: caracteres de ancho cero. Cuadro inferior: formato binario.',
    mobileAlertMedium: 'Cifrado completo. El cuadro superior contiene cifrado de caracteres de ancho cero, mientras que el inferior muestra cifrado binario.',
    tranli: 'El mensaje se destruirá automáticamente según su configuración.'
  },
  fr: {
    encryptTabTitle: 'Outil de Chiffrement de Caractères',
    coverTextLabel: 'Message Public (Entrée)',
    coverTextPlaceholder: 'Écrivez votre note ici...',
    hiddenTextLabel: 'Message Secret (Entrée)',
    hiddenTextPlaceholder: 'Écrivez les messages cachés ici...',
    encryptKeyLabel: 'Mot de passe',
    encryptKeyLabelConfirm: 'Confirmer le Mot de passe',
    encryptKeyPlaceholder: 'Entrez le mot de passe',
    encryptKeyPlaceholderConfirm: 'Confirmez le mot de passe',
    pass1Placeholder: 'Entrez le mot de passe',
    pass2Placeholder: 'Confirmez le mot de passe',
    btnZeroWidthEncrypt: 'Chiffrer en Largeur Zéro',
    btnBinaryEncrypt: 'Chiffrer en Binaire',
    encryptResultLabel: 'Résultat Chiffré à Largeur Zéro (Copier pour Partager)',
    encryptResultPlaceholder: 'Le résultat chiffré apparaîtra ici',
    binaryResultLabel: 'Résultat de Chiffrement Binaire',
    textareaPlaceholder: 'Écrivez votre note ici...',
    tranmake: 'Chiffrer la Note',
    btnCopyEncryptResult: 'Copier le Résultat à Largeur Zéro',
    btnCopyBinaryResult: 'Copier le Résultat Binaire',
    encryptInfo: '<strong>Info:</strong> Le chiffrement à largeur zéro cache le contenu caché dans le texte de couverture. Le chiffrement binaire convertit le contenu caché en 0/1. Vous pouvez définir un mot de passe personnalisé.',
    hiddenTextareaPlaceholder: 'Écrivez les messages cachés ici...',
    alertPasswordMismatch: 'Le mot de passe ne correspond pas ou effacez le mot de passe',
    alertContentTooLong: 'Trop long.....',
    alertWriteSomething: 'Écrivez quelque chose sur la note',
    mobileAlertShort: 'Chiffrement réussi ! Boîte supérieure : caractères à largeur zéro. Boîte inférieure : format binaire.',
    mobileAlertMedium: 'Chiffrement terminé. La boîte supérieure contient le chiffrement à caractères de largeur zéro, tandis que celle du bas affiche le chiffrement binaire.',
    tranli: 'Le message sera automatiquement détruit selon vos paramètres.'
  },
  ja: {
    encryptTabTitle: '文字暗号化ツール',
    coverTextLabel: '公開メッセージ（入力）',
    coverTextPlaceholder: 'ここにメモを書いてください...',
    hiddenTextLabel: '秘密メッセージ（入力）',
    hiddenTextPlaceholder: 'ここに隠しメッセージを書いてください...',
    encryptKeyLabel: 'パスワード',
    encryptKeyLabelConfirm: 'パスワード確認',
    encryptKeyPlaceholder: 'パスワードを入力',
    encryptKeyPlaceholderConfirm: 'パスワードを確認',
    pass1Placeholder: 'パスワードを入力',
    pass2Placeholder: 'パスワードを確認',
    btnZeroWidthEncrypt: 'ゼロ幅暗号化',
    btnBinaryEncrypt: 'バイナリ暗号化',
    encryptResultLabel: 'ゼロ幅暗号化結果（共有用にコピー）',
    encryptResultPlaceholder: '暗号化されたコンテンツがここに表示されます',
    binaryResultLabel: 'バイナリ暗号化結果',
    textareaPlaceholder: 'ここにメモを書いてください...',
    tranmake: 'メモを暗号化',
    btnCopyEncryptResult: 'ゼロ幅結果をコピー',
    btnCopyBinaryResult: 'バイナリ結果をコピー',
    encryptInfo: '<strong>情報：</strong>ゼロ幅暗号化は隠しコンテンツをカバーテキストに隠します。バイナリ暗号化は隠しコンテンツを0/1に変換します。カスタムパスワードを設定できます。',
    hiddenTextareaPlaceholder: 'ここに隠しメッセージを書いてください...',
    alertPasswordMismatch: 'パスワードが一致しないか、パスワードをクリアしてください',
    alertContentTooLong: '長すぎます.....',
    alertWriteSomething: 'メモに何か書いてください',
    mobileAlertShort: '暗号化成功！上のボックス：ゼロ幅文字。下のボックス：バイナリ形式。',
    mobileAlertMedium: '暗号化完了。上のボックスにはゼロ幅文字暗号化、下のボックスにはバイナリ暗号化が含まれています。',
    tranli: 'メッセージは設定に従って自動的に破棄されます。'
  },
  de: {
    encryptTabTitle: 'Zeichen-Verschlüsselungswerkzeug',
    coverTextLabel: 'Öffentliche Nachricht (Eingabe)',
    coverTextPlaceholder: 'Schreiben Sie Ihre Notiz hier...',
    hiddenTextLabel: 'Geheime Nachricht (Eingabe)',
    hiddenTextPlaceholder: 'Schreiben Sie hier versteckte Nachrichten...',
    encryptKeyLabel: 'Passwort',
    encryptKeyLabelConfirm: 'Passwort bestätigen',
    encryptKeyPlaceholder: 'Passwort eingeben',
    encryptKeyPlaceholderConfirm: 'Passwort bestätigen',
    pass1Placeholder: 'Passwort eingeben',
    pass2Placeholder: 'Passwort bestätigen',
    btnZeroWidthEncrypt: 'Nullbreiten-Verschlüsselung',
    btnBinaryEncrypt: 'Binär-Verschlüsselung',
    encryptResultLabel: 'Nullbreiten-Verschlüsselungsergebnis (Zum Teilen kopieren)',
    encryptResultPlaceholder: 'Verschlüsselter Inhalt wird hier angezeigt',
    binaryResultLabel: 'Binär-Verschlüsselungsergebnis',
    textareaPlaceholder: 'Schreiben Sie Ihre Notiz hier...',
    tranmake: 'Notiz verschlüsseln',
    btnCopyEncryptResult: 'Nullbreiten-Ergebnis kopieren',
    btnCopyBinaryResult: 'Binär-Ergebnis kopieren',
    encryptInfo: '<strong>Info:</strong> Nullbreiten-Verschlüsselung versteckt den versteckten Inhalt im Decktext. Binär-Verschlüsselung wandelt den versteckten Inhalt in 0/1 um. Sie können ein benutzerdefiniertes Passwort festlegen.',
    hiddenTextareaPlaceholder: 'Schreiben Sie hier versteckte Nachrichten...',
    alertPasswordMismatch: 'Passwort stimmt nicht überein oder Passwort löschen',
    alertContentTooLong: 'Zu lang.....',
    alertWriteSomething: 'Schreiben Sie etwas in die Notiz',
    mobileAlertShort: 'Verschlüsselung erfolgreich! Oberes Feld: Nullbreitenzeichen. Unteres Feld: Binärformat.',
    mobileAlertMedium: 'Verschlüsselung abgeschlossen. Das obere Feld enthält Nullbreitenzeichen-Verschlüsselung, während das untere Binär-Verschlüsselung zeigt.',
    tranli: 'Die Nachricht wird gemäß Ihren Einstellungen automatisch gelöscht.'
  }
};

// Initialize current language
let currentLanguage = 'en';

// Helper function to check if localStorage is available
function isLocalStorageAvailable() {
  try {
    const testKey = "__privnote_test__";
    localStorage.setItem(testKey, testKey);
    localStorage.removeItem(testKey);
    return true;
  } catch (e) {
    console.warn("localStorage not available. Language preferences won't be saved.");
    return false;
  }
}

// Load saved language if available
if (isLocalStorageAvailable()) {
  const savedLanguage = localStorage.getItem('privnote_language');
  if (savedLanguage) {
    currentLanguage = savedLanguage;
  }
}

// Helper function to get text based on current language
function getLocalizedString(stringKey, category = 'common') {
  let stringObject;
  
  switch(category) {
    case 'encryption':
      stringObject = languageEncryptionStrings[currentLanguage] || languageEncryptionStrings['en'];
      break;
    case 'common':
    default:
      stringObject = languageCommonStrings[currentLanguage] || languageCommonStrings['en'];
      break;
  }
  
  return stringObject[stringKey] || stringKey;
}

// Update user interface with the selected language
function applyLanguage(lang) {
  const commonStrings = languageCommonStrings[lang] || languageCommonStrings['en'];
  const encryptionStrings = languageEncryptionStrings[lang] || languageEncryptionStrings['en'];
  
  // Update common elements with flag icons
  if (lang === 'en') document.getElementById('currentLanguage').textContent = '🇺🇸 English';
  else if (lang === 'zh') document.getElementById('currentLanguage').textContent = '🇨🇳 中文';
  else if (lang === 'tw') document.getElementById('currentLanguage').textContent = '🇹🇼 中文';
  else if (lang === 'es') document.getElementById('currentLanguage').textContent = '🇪🇸 Español';
  else if (lang === 'fr') document.getElementById('currentLanguage').textContent = '🇫🇷 Français';
  else if (lang === 'ja') document.getElementById('currentLanguage').textContent = '🇯🇵 日本語';
  else if (lang === 'de') document.getElementById('currentLanguage').textContent = '🇩🇪 Deutsch';
  
  document.getElementById('trans1').textContent = commonStrings.tagline;
  document.getElementById('navLinkText').textContent = commonStrings.navLinkText;
  document.getElementById('navEncryptText').textContent = commonStrings.navEncryptText;
  document.getElementById('navDecryptText').textContent = commonStrings.navDecryptText;
  
  // Update encryption page elements
  document.getElementById('encryptTabTitle').textContent = encryptionStrings.encryptTabTitle;
  document.querySelector('label[for="myTextarea"]').innerHTML = '<i class="fas fa-edit me-1"></i>' + encryptionStrings.coverTextLabel;
  document.querySelector('label[for="HiddenTextarea"]').innerHTML = '<i class="fas fa-eye-slash me-1"></i>' + encryptionStrings.hiddenTextLabel;
  document.querySelector('label[for="pass1"]').textContent = encryptionStrings.encryptKeyLabel;
  document.querySelector('label[for="pass2"]').textContent = encryptionStrings.encryptKeyLabelConfirm;
  document.querySelector('label[for="coverCopy"]').innerHTML = '<i class="fas fa-key me-1"></i>' + encryptionStrings.encryptResultLabel;
  
  // Update placeholders
  document.getElementById('myTextarea').placeholder = encryptionStrings.textareaPlaceholder;
  document.getElementById('HiddenTextarea').placeholder = encryptionStrings.hiddenTextareaPlaceholder;
  document.getElementById('pass1').placeholder = encryptionStrings.pass1Placeholder;
  document.getElementById('pass2').placeholder = encryptionStrings.pass2Placeholder;
  document.getElementById('coverCopy').placeholder = encryptionStrings.encryptResultPlaceholder;
  
  // Update buttons
  document.getElementById('tranmake').innerHTML = '<i class="fas fa-lock me-2"></i>' + encryptionStrings.tranmake;
  document.querySelector('.btn-danger').innerHTML = '<i class="fas fa-copy me-2"></i>' + encryptionStrings.btnCopyEncryptResult;
  
  // Update other elements
  if (document.getElementById('tranli')) {
    document.getElementById('tranli').textContent = encryptionStrings.tranli;
  }
  
  // Update success message for mobile if displayed
  const successSpan = document.querySelector('#encryptinfo span');
  if (successSpan) {
    if (window.innerWidth < 576) {
      successSpan.textContent = encryptionStrings.mobileAlertShort;
    } else if (window.innerWidth < 768) {
      successSpan.textContent = encryptionStrings.mobileAlertMedium;
    }
  }
  
  // Visual indication in dropdown
  document.querySelectorAll('.dropdown-item').forEach(item => {
    item.classList.remove('active');
    if (item.getAttribute('onclick') && item.getAttribute('onclick').includes(`'${lang}'`)) {
      item.classList.add('active');
    }
  });
}

// Main function to switch language
function switchLanguage(lang) {
  currentLanguage = lang;
  
  // Save to localStorage if available
  if (isLocalStorageAvailable()) {
    localStorage.setItem('privnote_language', lang);
  }
  
  // Apply the language to the UI
  applyLanguage(lang);
}

// =======================================================================
// 2. ENCRYPTION AND DECRYPTION FUNCTIONS 
// =======================================================================

// 加密过程：使用XOR对文本进行加密，并转换为0和1的二进制
function textToBinaryEncryption(text, key) {
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));  // 转换密钥为字符的charCode数组

    // 第一步：对每个字符进行XOR加密，并转换为二进制
    const encryptedText = Array.from(text).map((char, index) => {
        // 使用密钥字符的charCode与当前字符的charCode进行异或运算
        let charCode = char.charCodeAt(0) ^ keyCodes[index % keyCodes.length];
        
        // 转换为二进制，返回的是0和1的字符串（每个字符的16位二进制表示）
        return charCode.toString(2).padStart(16, '0'); // 每个字符的二进制表示为16位
    }).join('');

    return encryptedText;
}

// 解密过程：从0和1的二进制恢复原始文本
function binaryToTextDecryption(binaryText, key) {
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));  // 转换密钥为字符的charCode数组

    // 分割二进制字符串为每16位一组（每个字符的16位二进制表示）
    const text = binaryText.match(/.{16}/g).map((bin, index) => {
        // 将二进制字符串转为整数（字符编码），并进行XOR解密
        let charCode = parseInt(bin, 2) ^ keyCodes[index % keyCodes.length];
        return String.fromCharCode(charCode);
    }).join('');

    return text;
}

// 使用统一的 16 位二进制进行 XOR 加密，并转换为零宽字符
function textToZeroWidthWithDoubleEncryption(text, key) {
    // 将密钥字符串转为字符的 charCode 数组
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));

    // 第一步：XOR 加密
    const xorEncryptedText = Array.from(text).map((char, index) => {
        // 使用 keyCodes 中的字符与原始字符的 charCode 进行异或运算
        let charCode = char.charCodeAt(0) ^ keyCodes[index % keyCodes.length];
        
        // 将字符编码强制为 16 位二进制字符串，确保统一长度
        return charCode.toString(2).padStart(16, '0');
    }).join('');

    // 第二步：将 XOR 加密后的二进制转换为零宽字符
    return xorEncryptedText.split('').map(bit => bit === '0' ? '\u200B' : '\u200C').join('');
}

// 解密流程：先解码零宽字符，再使用 XOR 解密
function zeroWidthToTextWithDoubleDecryption(zeroWidthText, key) {
    // 将密钥字符串转为字符的 charCode 数组
    const keyCodes = Array.from(key).map(char => char.charCodeAt(0));

    // 将零宽字符转换为二进制字符串
    const binary = Array.from(zeroWidthText).map(char => {
        return char === '\u200B' ? '0' : '1';
    }).join('');

    // 每16个二进制位恢复为一个字符
    const text = binary.match(/.{16}/g).map((bin, index) => {
        let charCode = parseInt(bin, 2) ^ keyCodes[index % keyCodes.length];
        return String.fromCharCode(charCode);
    }).join('');

    // 检查并替换最后一个字符是否是非法字符（如半角字符）
    if (text.charCodeAt(text.length - 1) < 32 || text.charCodeAt(text.length - 1) > 126) {
        // 如果最后一个字符是非法字符（如换行符、回车符），就替换为空格
        return text.slice(0, -1) + ' ';
    }
    return text;
}

// =======================================================================
// 3. UI INTERACTION FUNCTIONS
// =======================================================================

// Copy text from textarea to clipboard
function copyTextarea(id) {
    var textarea = document.getElementById(id);
    textarea.select();
    document.execCommand('copy');
    
    // Visual feedback for copy
    let button;
    if (id === 'coverCopy') {
        // 直接找到按钮而不是使用 nextElementSibling
        button = document.querySelector('.btn-danger[onclick="copyTextarea(\'coverCopy\')"]');
    } else {
        // 二进制结果的按钮，因为是动态创建的，使用部分匹配
        button = document.querySelector('.btn-info[onclick*="' + id + '"]');
    }
    
    if (button) {
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check me-2"></i>Copied!';
        
        setTimeout(() => {
            button.innerHTML = originalText;
        }, 2000);
    }
}

// Copy link from innerlink element
function copylink() {
     const exampleLi = document.getElementById('innerlink');
     const exampleText = exampleLi.textContent;
     navigator.clipboard.writeText(exampleText)
  .then(() => {
    var button = document.getElementById("copybutton");
    button.classList.add('rotate');
    button.textContent = "Link Copied";
  })
  .catch((err) => {
    console.error('Error copying text: ', err);
  });
}

// Simulate typing effect for text display
function simulateTyping(elementId, text, speed) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    element.value = '';
    let i = 0;
    
    function type() {
        if (i < text.length) {
            element.value += text.charAt(i);
            i++;
            setTimeout(type, speed);
        }
    }
    
    type();
}

// Main function to create encrypted content
function create() {
   const textarea = document.getElementById('myTextarea');
   textareaValue = textarea.value; 
   const hiddentext = document.getElementById('HiddenTextarea');
   hiddentextValue = hiddentext.value; hiddentextValue += ' \n ';
  let totallength = textareaValue.length + hiddentextValue.length;

  if(totallength > 30000){
    alert(getLocalizedString('alertContentTooLong', 'encryption'));
    return;
  }

  if (textareaValue === ""){
    alert(getLocalizedString('alertWriteSomething', 'encryption'));
    return;
  }

   pass1 = document.getElementById('pass1').value;
   pass2 = document.getElementById('pass2').value;
   
  if (pass1 === "" && pass2 === "") {
    pass1 = 'mythenigma';  
  } else if (pass1 === pass2) {
    pass1 = pass2;
  } else {
    alert(getLocalizedString('alertPasswordMismatch', 'encryption'));
    return;
  }

 const encodedSecretMessage = textToZeroWidthWithDoubleEncryption(hiddentextValue, pass1);
 const encodedSecretMessage01= textToBinaryEncryption(hiddentextValue, pass1); 
 combineallvalue =  encodedSecretMessage + textareaValue;
 textareaValue   =  combineallvalue;
 textarea.value  =  combineallvalue;
 hiddentext.value=   encodedSecretMessage01;
 
 // Show the result
 document.getElementById('encryptinfo').style.display = 'block';
 document.getElementById('coverCopy').value = textarea.value;
 
 // 将HiddenText框移动到最下面
 const hiddenTextContainer = document.getElementById('hiddenTextContainer');
 const hiddenTextAfterEncrypt = document.getElementById('hiddenTextAfterEncrypt');
 const hiddenTextArea = document.getElementById('HiddenTextarea');
 
 // 修改标签文本，更清晰地表示这是二进制加密结果
 const label = hiddenTextContainer.querySelector('label');
 label.innerHTML = '<i class="fas fa-code me-1"></i>' + getLocalizedString('binaryResultLabel', 'encryption');
 
 // 从父元素中移除原始 textarea
 const hiddenTextParent = hiddenTextArea.parentNode;
 hiddenTextParent.removeChild(hiddenTextArea);
 
 // 给二进制结果框添加左边框样式 - 使用蓝色
 hiddenTextArea.style.borderLeft = '4px solid #17a2b8';
 hiddenTextArea.style.background = 'linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9))';
 hiddenTextArea.className = 'form-control mb-2'; // 添加 mb-2 以在文本框和按钮之间创建间距
 
 // 将原始 textarea 添加回父容器
 hiddenTextParent.appendChild(hiddenTextArea);
 
 // 显示结果
 document.getElementById('coverCopy').style.borderLeft = '4px solid #dc3545';
 document.getElementById('coverCopy').style.background = 'linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 240, 240, 0.9))';
 
 // 创建复制按钮并添加到文本框下方
 const copyButton = document.createElement('button');
 copyButton.className = 'btn btn-info';  // 使用蓝色按钮(info)，区别于上面的红色按钮(danger)
 copyButton.type = 'button';
 copyButton.innerHTML = '<i class="fas fa-copy me-2"></i>' + getLocalizedString('btnCopyBinaryResult', 'encryption');
 copyButton.onclick = function() { copyTextarea('HiddenTextarea'); };
 copyButton.style.width = 'auto'; // 设置按钮宽度为自动
 copyButton.style.display = 'block'; // 设置为块级元素
 
 // 创建一个按钮容器，用于居中显示按钮
 const buttonContainer = document.createElement('div');
 buttonContainer.className = 'd-flex justify-content-center';
 buttonContainer.appendChild(copyButton);
 
 // 将按钮容器添加到父容器
 hiddenTextParent.appendChild(buttonContainer);
 
 // 从原位置移除并附加到底部容器
 hiddenTextAfterEncrypt.appendChild(hiddenTextContainer);
 
 // 添加一些顶部间距，使其与上面的内容有更好的视觉分隔
 hiddenTextContainer.classList.add('mt-4');
 
 // 更新成功消息文本根据屏幕尺寸
 updateSuccessMessage();
}

// Update success message based on screen size
function updateSuccessMessage() {
  const alertSpan = document.querySelector('#encryptinfo span');
  if (alertSpan) {
    if (window.innerWidth < 576) {
      alertSpan.textContent = getLocalizedString('mobileAlertShort', 'encryption');
    } else if (window.innerWidth < 768) {
      alertSpan.textContent = getLocalizedString('mobileAlertMedium', 'encryption');
    }
  }
}

// Handle screen size changes for mobile optimization
function adjustForMobileView() {
  if (window.innerWidth < 768) {
    // Adjust textarea rows for better mobile viewing
    document.querySelectorAll('textarea').forEach(textarea => {
      textarea.rows = 4;
    });
    
    // Update success message if visible
    updateSuccessMessage();
    
    // Adjust button text for smaller screens
    const copyZeroWidthBtn = document.querySelector('.btn-danger[onclick="copyTextarea(\'coverCopy\')"]');
    if (copyZeroWidthBtn && window.innerWidth < 400) {
      copyZeroWidthBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Copy';
    }
  }
}

// Call the function on page load and resize
window.addEventListener('load', adjustForMobileView);
window.addEventListener('resize', adjustForMobileView);

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  console.log("DOM fully loaded, initializing UI...");
  
  // Apply current language from localStorage or default
  applyLanguage(currentLanguage);
  
  // Override create function for mobile displays
  const originalCreate = create;
  create = function() {
    originalCreate();
    
    // After encryption, if on mobile, modify the dynamically created button text to be shorter
    if (window.innerWidth < 400) {
      const binaryResultBtn = document.querySelector('.btn-info[onclick*="HiddenTextarea"]');
      if (binaryResultBtn) {
        binaryResultBtn.innerHTML = '<i class="fas fa-copy me-1"></i>Copy';
      }
    }
    
    // Scroll to the results on mobile
    if (window.innerWidth < 768) {
      document.getElementById('encryptinfo').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
  };
});

// Variables for encryption functions
var textareaValue = '';
var expiretime = 0;
var confirmask = 1;
var pass1 = '';
var pass2 = '';
var myArray = '';
var lastElement = '';
var globename = '';
var combineallvalue = '';
</script>

</body>
</html>
